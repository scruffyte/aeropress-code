/** C O N F I G U R A T I O N   B I T S ******************************/

#pragma config FOSC = INTIO67, FCMEN = OFF, IESO = OFF                      // CONFIG1H
#pragma config PWRT = OFF, BOREN = OFF, BORV = 30                           // CONFIG2L
#pragma config WDTEN = OFF, WDTPS = 32768                                   // CONFIG2H
#pragma config MCLRE = ON, LPT1OSC = OFF, PBADEN = ON, CCP2MX = PORTC       // CONFIG3H
#pragma config STVREN = ON, LVP = OFF, XINST = OFF                          // CONFIG4L
#pragma config CP0 = OFF, CP1 = OFF, CP2 = OFF, CP3 = OFF                   // CONFIG5L
#pragma config CPB = OFF, CPD = OFF                                         // CONFIG5H
#pragma config WRT0 = OFF, WRT1 = OFF, WRT2 = OFF, WRT3 = OFF               // CONFIG6L
#pragma config WRTB = OFF, WRTC = OFF, WRTD = OFF                           // CONFIG6H
#pragma config EBTR0 = OFF, EBTR1 = OFF, EBTR2 = OFF, EBTR3 = OFF           // CONFIG7L
#pragma config EBTRB = OFF                                                  // CONFIG7H

/** I N C L U D E S **************************************************/

#include "p18f45k20.h"
#include "header_V1-0.h"
#include "delays.h"

/** D E F I N E S ****************************************************/

#define DIR_PIN PORTDbits.RD6
#define STEP_PIN PORTDbits.RD7

/** V A R I A B L E S ***********************************************/

#pragma udata                       // declare statically allocated uinitialized variables

void initIO(void) {
	ANSEL  = 0;	                        	    // set i/o to digital
    ANSELH = 0; 
    TRISDbits.TRISD7 = 0;
	TRISCbits.TRISC1 = 0;
    TRISAbits.TRISA4 = 1;
    TRISAbits.TRISA5 = 1;
}
void initPWM(void) {
    unsigned char speed = 125; // = 0x7D
    T2CON = 0b00000111;
    PR2 = 249;
    CCP1CON = 0b01001100;
    CCP2CON = 0b01001100;
}

void main (void) {
		initIO();
		initPWM();
        while(1) {
        if (PORTAbits.RA4 == 0) { // Check if the switch is pressed
            CCPR1L = 255;   // Set the duty cycle for motor 1 (0-255)
        } else {
            CCPR1L = 0;      // Turn off motor 1 if the switch is not pressed
        }
        if (PORTAbits.RA5 == 0) {
            CCPR2L = 255;   // Set the duty cycle for motor 2 (0-255)
        } else {
            CCPR2L = 0;      // Turn off motor 2 if the switch is not pressed
        }
            
    }
}
